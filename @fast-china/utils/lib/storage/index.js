"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const e=require("vue"),r=require("../base64/index.js"),o=require("../console/index.js"),i=e.reactive({prefix:"fast__",expireSuffix:"__Expire",crypto:!1}),t=e.computed((()=>i.prefix)),n=e.computed((()=>i.expireSuffix)),s={set(e,r){"undefined"!=typeof uni?uni.setStorageSync(e,r):window.localStorage.setItem(e,r)},get:e=>"undefined"!=typeof uni?uni.getStorageSync(e):window.localStorage.getItem(e),remove(e){"undefined"!=typeof uni?uni.removeStorageSync(e):window.localStorage.removeItem(e)},clear(){"undefined"!=typeof uni?uni.clearStorageSync():window.localStorage.clear()},keys:()=>"undefined"!=typeof uni?uni.getStorageInfoSync().keys:window.localStorage},f={set(e,t,n,f){try{if(f??(f=i.crypto),n){if(isNaN(n)||n<1)throw new Error("有效期应为一个有效数值");const r={time:Date.now(),expire:n},o=JSON.stringify(r);s.set(`${i.prefix}${e}${i.expireSuffix}`,o)}let o=JSON.stringify(t);f&&(o=r.base64Util.toBase64(o)),s.set(`${i.prefix}${e}`,o)}catch(c){o.consoleError("Local",c)}},get(e,t){try{t??(t=i.crypto);let o=s.get(`${i.prefix}${e}`);if(o){t&&(o=r.base64Util.base64ToStr(o));const n=s.get(`${i.prefix}${e}${i.expireSuffix}`);if(n){const r=JSON.parse(n);if(Date.now()>r.time+60*r.expire*1e3)return s.remove(`${i.prefix}${e}`),s.remove(`${i.prefix}${e}${i.expireSuffix}`),null}try{return JSON.parse(o)}catch{return o}}return null}catch(n){o.consoleError("Local",n)}},remove(e){try{s.remove(`${i.prefix}${e}`),s.remove(`${i.prefix}${e}${i.expireSuffix}`)}catch(r){o.consoleError("Local",r)}},removeByPrefix(e){try{for(const r in s.keys)-1!==r.indexOf(`${i.prefix}${e}`)&&s.remove(r)}catch(r){o.consoleError("Local",r)}},clear(){try{s.clear()}catch(e){o.consoleError("Local",e)}}},c={set(e,t,n,s){if("undefined"==typeof uni)try{if(s??(s=i.crypto),n){if(isNaN(n)||n<1)throw new Error("有效期应为一个有效数值");const r={time:Date.now(),expire:n},o=JSON.stringify(r);window.sessionStorage.setItem(`${i.prefix}${e}${i.expireSuffix}`,o)}let o=JSON.stringify(t);s&&(o=r.base64Util.toBase64(o)),window.sessionStorage.setItem(`${i.prefix}${e}`,o)}catch(f){o.consoleError("Session",f)}else o.consoleError("Session","UniApp 环境下 [Session] 不可用。")},get(e,t){if("undefined"==typeof uni)try{t??(t=i.crypto);let o=window.sessionStorage.getItem(`${i.prefix}${e}`);if(o){t&&(o=r.base64Util.base64ToStr(o));const n=window.sessionStorage.getItem(`${i.prefix}${e}${i.expireSuffix}`);if(n){const r=JSON.parse(n);if(Date.now()>r.time+60*r.expire*1e3)return window.sessionStorage.removeItem(`${i.prefix}${e}`),window.sessionStorage.removeItem(`${i.prefix}${e}${i.expireSuffix}`),null}try{return JSON.parse(o)}catch{return o}}return null}catch(n){o.consoleError("Session",n)}else o.consoleError("Session","UniApp 环境下 [Session] 不可用。")},remove(e){if("undefined"==typeof uni)try{window.sessionStorage.removeItem(`${i.prefix}${e}`),window.sessionStorage.removeItem(`${i.prefix}${e}${i.expireSuffix}`)}catch(r){o.consoleError("Session",r)}else o.consoleError("Session","UniApp 环境下 [Session] 不可用。")},removeByPrefix(e){if("undefined"==typeof uni)try{for(const r in window.sessionStorage)-1!==r.indexOf(`${i.prefix}${e}`)&&window.sessionStorage.removeItem(r)}catch(r){o.consoleError("Session",r)}else o.consoleError("Session","UniApp 环境下 [Session] 不可用。")},clear(){if("undefined"==typeof uni)try{window.sessionStorage.clear()}catch(e){o.consoleError("Session",e)}else o.consoleError("Session","UniApp 环境下 [Session] 不可用。")}};exports.CACHE_EXPIRE_SUFFIX=n,exports.CACHE_PREFIX=t,exports.Local=f,exports.Session=c,exports.useStorage=()=>({prefix(e){i.prefix=e},expireSuffix(e){i.expireSuffix=e},crypto(e){i.crypto=e}});
//# sourceMappingURL=index.js.map
